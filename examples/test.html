<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<title>nodom-examples css</title>
		</head>

	<body>
		
	</body>
	<script type='module'>
		import{nodom,Nodom,Module,GlobalCache} from '/dist/nodom.esm.js'
		//无论数据是否存在，都可以订阅
		GlobalCache.set("globalData", {
			msg: 0,
		});
		
		class ModuleA extends Module {
			template() {
				return ` 
					<div>
						<button e-click="change">change</button>
					</div>
				`;
			}
			change() {
				let data = GlobalCache.get("globalData");
				if(!data){
					data = {msg:0}
				}else{
					data.msg++;
				}
				GlobalCache.set("globalData",data);
			}
		}
		
		class ModuleB extends Module {
			template() {
				return ` 
					<div>
						moduleb global data is:{{msg}}
					</div>
				`;
			}
			onInit(model) {
				//订阅数据，如果globalData内部数据发生改变，则会触发回调函数
				GlobalCache.subscribe(this, "globalData", (val) => {
					model.msg = val.msg;
				});
			}
		}
		
		class Main extends Module {
			modules = [ModuleA,ModuleB];
			template() {
				return `
					<div>
						main global data is:{{msg}}
						<ModuleA />
						<ModuleB />
					</div>
				`;
			}
			onInit(model) {
				//订阅数据，如果globalData内部数据发生改变，则会触发回调函数
				GlobalCache.subscribe(this, "globalData", (val) => {
					model.msg = val.msg;
				});
			}
		}
		Nodom.app(Main);
	</script>
</html>
